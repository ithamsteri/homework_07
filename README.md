# Домашнее задание 07

[![Build Status](https://travis-ci.org/ithamsteri/homework_07.svg?branch=master)](https://travis-ci.org/ithamsteri/homework_07)

## Условие задания

Разобрать программу для пакетоной обработки команд. Команды считываются
построчно из стандартного ввода и обрабатываются блоками по N команд.
Одна команда - одна строка, значение роли не играет. Если данные закончились -
блок завершается принудительно.

Параметр N передаётся как единственный параметр командной строки в виде целого
числа.

```
input | output
------|-------
cmd1  |
cmd2  |
cmd3  |
      | bulk: cmd1, cmd2, cmd3
cmd4  |
cmd5  |
      | bulk: cmd4, cmd5
```

Размер блока можно изменить динамически, если перед началом блока и сразу после
дать команды `{` и `}` соотвественно. Предыдущий пакет при этом принудительно
завершится.

```
input | output
------|-------
cmd1  |
cmd2  |
cmd3  |
      | bulk: cmd1, cmd2, cmd3
{     |
cmd4  |
cmd5  |
cmd6  |
cmd7  |
}     |
      | bulk: cmd4, cmd5, cmd6, cmd7
```

Такие блоки могут быть включены друг в друга при этом вложенные блоки
игнорируются.

```
input | output
------|-------
{     |
cmd1  |
cmd2  |
{     |
cmd3  |
cmd4  |
}     |
cmd5  |
cmd6  |
}     |
      | bulk: cmd1, cmd2, cmd3, cmd4, cmd5, cmd6
```

Если данные закончились внутри блока - блоки игнорируются целеком.

```
input | output
------|-------
cmd1  |
cmd2  |
cmd3  |
      | bulk: cmd1, cmd2, cmd3
{     |
cmd4  |
cmd5  |
cmd6  |
cmd7  |
```

Вместе с выводом в консоль блоки должны сохраняться в отдельные файлы с именами
`bulk1517223860.log`, где `1517223860` - это время получения первой команды из
блока.

## Требования к реализации

Бинарный файл должен называется `bulk`.

Результатом работы должен быть пакет `bulk` опубликованный на bintray.

## Проверка

Задание считается выполненным успешно, если после установки пакета и запуска с
тестовыми данными вывод соответствует описанию. Данные попадаются на
стандратный вход построчно с паузой в 1 секунду для визуального контроля.

Будет отмечена скорость выполнения задания, узнаваемый шаблон "наблюдатель",
низкая связанность обработки данных, накопления пачек команд, вывода в консоль
и сохранения в файлы.

## Установка, сборка и тестирование

### Установка пакета

Для Ubuntu Trusty нужно сделать следующее:

```shell
echo "deb http://dl.bintray.com/hamsterisoftware/deb-repo trusty main" | sudo tee -a /etc/apt/sources.list
sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 379CE192D401AB61
sudo apt-get update && sudo apt-get install bulk
```

### Генерация сборки

Запустить в корневом каталоге проекта

```shell
cmake -H. -BBuild -DBUILD_TESTING=ON
```

### Сборка проекта

Запустить в каталоге Build

```shell
cmake --build .
```

### Тестирование проекта

Запустить в каталоге Build

```shell
cmake --build . --target test
```

### Сборка пакета

Запустить в каталоге Build

```shell
cmake --build . --target package
```
